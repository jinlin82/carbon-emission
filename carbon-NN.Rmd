---
title: "基于灰色BP神经网络碳排放权交易价格预测"
author: "Jin"
date: "2019-03-02"
output:
  bookdown::word_document2:
    fig_caption: true
    reference_docx: ./style/word-styles-02.docx
    md_extensions: +east_asian_line_breaks
    pandoc_args: ["--filter", "pandoc-crossref"]
  bookdown::html_document2:
    number_sections: true
    seq_numbering: true
    fig_caption: true
    highlight: haddock
    theme: null
    md_extensions: +east_asian_line_breaks
    keep_md: true
    toc: true
    pandoc_args: ["--filter", "pandoc-crossref", "-M", "eqnPrefix="]
  bookdown::pdf_document2:
    keep_tex: yes
    toc: false
    latex_engine: xelatex
    md_extensions: +east_asian_line_breaks
    pandoc_args: ["--listing", "--filter", "pandoc-crossref"]
css: ./style/markdown.css
autoEqnLabels: true
eqnPrefixTemplate: ($$i$$)
linkReferences: true
bibliography: Bibfile.bib
csl: ./style/chinese-gb7714-2005-numeric.csl
link-citations: true
---

```{r setup, echo=F}
knitr::opts_knit$set(root.dir = getwd())
knitr::opts_chunk$set(echo = FALSE, results = 'hide')
knitr::opts_chunk$set(warning = FALSE, message=FALSE)
```

```{r prepare}
rm(list=ls())
options(digits=4)
options(scipen=100)
graphics.off()
Sys.setlocale("LC_ALL", "Chinese")
```

**TODO**

- [X] 把数据和程序打包
- [X] 图重新画，在生成的word里面图像的字体太小了
- [X] 把图形位置替换为生成图形的R代码
- [X] 分成两篇文章：1. 基于灰色BP神经网络碳排放权交易价格预测； 2. 基于Prophet自动预测模型碳排放权交易价格预测

**摘要：** 本文从政府和企业两个角度出发选取国内6个碳交易试点地区作为研究对象，重
点探究了国内碳交易价格的影响因素作用机理及预测问题，结果发现我国正处于受能源价格
影响的初级阶段，宏观经济影响微弱，股市联动性差，并且能源价格呈负向作用，这种负向
作用从煤炭、天然气到原油依次递减；对于碳交易价格的预测问题宜采用灰色BP神经网络进
行短期预测，有效期需控制在15期内。

# 简介
[//]: # 问题界定，文献综述，文章结构简述

近几年来，全球极端天气频繁发生，平均气温升温超过1℃，这与全球碳排放量与日俱增密
切相关。若任由形势继续发展下去，必将严重威胁人类的生存与发展。中国作为全球最大的
温室气体排放国，为应对全球气候变化，我国已经和175个国家签署了《巴黎气候协定》，
并在多次政府工作会议中指出要加快推动碳市场的建设和碳金融的发展。碳排放交易市场的
建设是控制温室气体排放的重大创新举措，是我国生态文明建设的重点目标之一。但我国碳
排放交易（以下简称碳交易）市场的建立起步较晚，在经历了4年地区试点探索后，2017年
12月19日我国碳排放交易系统正式启动。当下我国正处于全面建设碳排放交易市场的初级阶
段，处于全球碳交易链条的底端，国际话语权不足，同时市场机制尚未完善，其发展仍然存
在很多制约因素，而价格作为调节碳交易市场的经济手段，研究其影响因素的作用机理和预
测价格变动规律，对于深入了解碳市场，推进碳交易市场全面健康持久的发展具备重要意义。

我国碳排放交易市场是参照欧盟碳排放权交易体系（EU Emissions Trading System）建立
起来的。欧盟碳交易体系市场机制成熟，运行时间长，当下对欧盟碳交易体系市场价格的研
究成果也相对较多。陈晓红和王陟昀（2012）以欧盟排放交易体系为样本开展研究发现,受
政策和制度影响的配额供给是交易价格最重要影响因素，煤炭价格是最大的能源影响因素，
天气因素影响不明显[@陈晓红2012]。Aatola(2013)研究欧盟碳排放市场发现碳交易期货价
格与电力价格、能源价格存在强相关性[@Aatola2013Price]。Deeney(2016)采用事件分析法
探究了欧洲议会的决议对于欧盟碳市场价格波动影响[@Deeney2016Influences]。Tan(2017)
基于分位数回归探究了碳排放价格与能源、经济因素的依赖关系和影响路径，发现前期能源
价格对碳市场冲击影响大，后期工业发展、股票市场因素的影响力逐渐提升
[@Tan2017Dependence]。

与欧盟碳排放市场相比，国内碳交易市场仍处于成长阶段，市场机制尚待完善。在国际市场
已经逐渐形成了以宏观经济、能源市场为主要影响因素，政策因素等其他因素为辅的影响系
统时，我国学者利用当下碳试点地区积累的数据，也纷纷开展了碳排放权价格的研究。王倩
(2015)认为中国碳交易市场需求方起主导地位，能源、气候、经济对碳交易价格的波动有显
著影响[@王倩2015]。赵立祥(2016)研究得出碳交易价格的首要影响因素是市场环境,而政策
和气候环境具备一定的影响，能源价格影响微弱[@赵立祥2016]。樊艳艳(2017)采用稳健的
静态面板回归模型发现煤炭价格波动对碳排放交易价格具备显著影响[@樊艳艳2017]。但这
些研究在选择碳排放价格可能影响因素时，考虑的因素数量相对较少，而且选择的时候主观
随意性较大。随着市场成熟度不断提升，交易者对于碳交易价格波动的变化关注度越来越高，
准确地预测碳交易价格对于市场参与者进行经济决策显得尤为重要。如姚奕等(2017)通过
EMD-SVM模型对湖北碳市场碳交易价格进行了预测并取得较好效果[@姚奕2017]。张晨和杨仙
子（2016）使用灰色马尔科夫模型预测碳价波动[@张晨2016]。胡根华和朱福敏（2018）使
用无穷活动率Levy过程构建了碳价格波动率模型[@胡根华2018]。

随着数据科学和大数据方法的发展，我们可以使用变量选择的统计方法来更客观地确定我国
碳排放交易市场价格影响因素，使用机器学习的方法更准确的预测碳交易价格。本文构建指
标体系并获取数据后进行数据检验并建立Lasso回归，客观地筛选出影响碳交易价格的重要
影响因子，根据已经筛选的重要变量和自身波动的特点，建立灰色BP神经网络预测模型对预
测碳交易价格进行预测。文章第二部分对碳排放交易市场价格形成机制和可能存在的影响因
素进行讨论，第三部分对可能的影响因素确定测量变量并收集数据，建立预测模型，进行实
证分析，最后是结论。

# 碳排放交易市场价格形成机制和影响因素

碳排放交易机制是指在设定碳排放总量的强制性目标下，允许市场主体进行碳排放权的买进
卖出行为，通过市场机制化解碳排放权的分配矛盾，以经济鼓励的方式鼓励市场参与者参与
到节能减排行动中从而达到减少温室气体排放的交易机制。其中碳是指以CO2为代表的温室
排放气体，碳排放权是在依据各市场主体实情设定碳排放总量一定的条件下，国际组织允许
各国、省份、地市级等向大气中排放温室气体的权利。从表现形式上看，碳排放权表现为强
制碳排放目标下被允许排放到大气中CO2数量。

当碳排放权与金融发生勾兑时，这种权利则变成了具备特殊形式价值的有价资产——碳资产，
从而演变成特殊的商品可以市场中进行买卖行为。碳交易可分为配额市场和交易市场两个板
块。首先，配额市场中，政府机构需要评估各省份、地级市在环境容纳范围内的最大碳排放
量，将所估算的数量划分为若干份额，政府通过免费发放、招标拍卖等方式，将碳排放权的
份额发放给各个企业。在国内国务院主管部门根据经济增长、产业结构、能源结构等多种因
素综合考量温室气体排放的总数额，然后从上而下根据实际情况分配各省、地级市碳配额量，
其分配方式主要以免费配额和有偿分配结合的方式，借助历史排放水平、行业标准或者企业
自身需求，向下分配碳排放权。企业通过一定的渠道获取排放权后，可在交易市场上进行交
换，减排任务艰巨的企业可以购买减排容易企业的碳排放权，后者通过技术更新等方式不仅
仅减少碳排放量，而且通过交易市场获取额外的收益，这敦促了减排困难的企业不断更新设
备技术等积极手段参与减排任务中。买卖双方在减排额一定的条件下进行交易，从而使得排
放量降低在一定的范围内。交易市场逐渐完善后，政府将逐步减少总排放权的发放，碳排放
权配额逐渐稀缺，碳交易价格提高，企业不断更新技术完成减排任务，碳排放总量呈现出绝
对下降趋势，最终缓解气候问题。

碳交易价格的形成实际上是在市场经济的条件下，供需双方进行博弈，最终形成均衡价格的
过程。本文以供需理论为切入点，分别从供给端、需求端来阐明影响因子，其中碳交易供给
方是EU ETS分配的碳配额总量，是结合自身需求向我国所分配的碳配额。分析当下环境，我
国碳交易市场的总供给将在一定水平内保持平稳，并随着节能技术突破难度更大，气候环境
形势愈加严峻，其供给会逐渐减少，供给曲线左移，总需求不变，碳交易价格上升。从需求
的角度分析，碳排放权需求增加主要受到市场基本环境和不确定事件两个方面的影响。其中
市场基本环境主要是指受宏观经济变动、能源价格、气候环境或国际市场的影响从而导致碳
排放权的需求增大或减少；不确定事件主要是指由于政策发布、经济危机或履约期等多种不
能预测其影响程度或者发生时间的一些因素。由于不确定事件具有复杂多变性、不可预测性、
不可量化性，所以本文主要从市场基本面上开展本文的研究。本文总结了如下四个方面。

（一）宏观经济

经济的发展水平直接影响着社会的需求和消费，碳交易系统活动的进行离不开市场经济，宏
观经济的波动必然会给碳交易价格的涨跌带来影响。当经济衰退、市场低迷时，消费者便会
减少消费，企业产量下降，大量资源被闲置，碳排放量需求减少，碳交易价格下跌。经济势
头良好，消费意愿提升，企业扩大生产，资源得以充分利用时，碳排放量需求提高，价格上
升，所以理论上宏观经济的变动与碳交易价格的变动呈正向变动关系。

（二）能源价格

二氧化碳排放的重要源头之一是化石燃料的燃烧。一方面碳排放交易市场通过对成本控制的
方式改变了企业对化石燃料的消耗量。当碳交易价格上涨时，出于对自身生产成本的考量，
企业不得不减少对碳排放权的购买和使用，纷纷减少对碳排放权的需求，化石能源价格也将
因人们对其需求的下降而下降。另一方面，企业可以通过更新技术、改变能源利用方式，提
高能源利用效率，转变传统消耗型经济发展方式，减少化石能源市场的交易，出售碳排放权
获取利益，缓解化石燃料消耗压力大的企业，这些举措都会造成二氧化碳排放量的下降，总
体需求下降，从而影响碳排放权的数量和价格。总的来说，能源价格与碳交易价格就形成了
反向变化的内在联系，且理论上碳交易价格对化石能源的价格影响更为显著。

（三）气候环境

气候环境中影响碳交易价格的主导因素之一是温度，当处于极度炎热或极度严寒的环境状态
下时，人们会提高使用制冷设备的频率或增加热力供应需求，能源需求上升，CO2排放增加，
因而碳交易价格也随之变动。另一方面空气中温室气体的含量直接决定着碳交易价格的制定，
近些年来空气污染越来越严重，“三废”的大量排放导致空气质量越来越差，雾霾天气严重。
环保部门制定了空气质量指数(AQI)来测量空气质量等级，AQI较为直观的反映了空气中温室
气体的含量，从而影响碳交易价格的走向。

（四）国际市场

欧盟是全球碳排放主要需求者，欧盟各国设定一定的配额量，而这个配额量会直接影响各国
对碳排放的需求，核准减排量（CER）的需求主体是发达国家具中有碳排放权缺口的企业，
而供给端便是发展中国家清洁减排机制的企业。供需双方的缺口直接影响了国内碳交易价格，
而核准减排量便是衡量此缺口的重要指标。另一方面由于国内市场和国外市场的差异，汇率
作为衡量不同币种的货币价值，直接影响了国内外碳交易的差价，市场中的交易者偏向价格
更具优势的市场进行买卖碳排放权，从而影响了单个市场的碳交易价格走势。

如上述所述，当下我国碳排放交易体系运行到完善模拟阶段，处于全国碳排放权交易市场建
设的关键时期，通过借鉴国际市场的经验，我们总结出国际碳价的主要影响因素包含宏观经
济、能源价格、气候环境和国际市场四大基本面，其作用原理在前文已具体阐述，但对于国
内市场，影响情况具体如何还需要进一步分析。另外，为防止建立初期，碳排放交易市场过
度的投机交易，我国目前的碳交易尚只有现货交易，未效仿国外推出碳期货市场，所以本文
以中国碳排放交易现货市场为研究出发点，重点研究现货市场下，我国碳交易价格的影响因
素及预测问题。



碳排放交易机制是指在政府设定碳排放总量的强制性目标下，允许市场主体进行碳排放权的
买进卖出行为，通过市场机制化解碳配额的分配矛盾，以经济鼓励的方式鼓励市场参与者参
与到节能减排行动中从而达到减少温室气体排放的交易机制。而核心——碳交易价格的形成和
波动实际上是在市场经济的条件下，供需双方进行博弈，最终形成均衡价格的过程。具体看
来，供给方是政府，其根据EU ETS所获得的配额总量及各试点地区的实际情况分配碳排放权
并制定初始价格；需求方为所需碳配额的企业，当企业通过一定渠道获得配额后，其可以在
二级市场进行配额交易，减排任务艰巨的企业可以购买减排容易企业的碳配额，后者通过自
身剩余的碳配额量在市场上获得收益，而前者则不断革新技术缩减碳配额支出从而使自身处
于有利地位。这一过程供需双方的缺口不断变化必然会造成了二级市场碳交易价格的波动，
从而引起碳交易价格的上升或下降。从上述运行原理我们发现碳交易价格研究存在的两个重
点在于政府对于价格的初始制定即价格的形成和二级市场上价格变动的预测。

从政府层面来看，我国碳交易市场的总供给将在一定水平内保持平稳，并随着气候环境形势
愈加严峻，其供给会逐渐减少，供给曲线向左移动，总需求不变的前提下，碳交易价格上升。
当然碳交易价格也会受到需求端的影响，需求端的影响可以分为市场基本环境和不确定事件
两个方面，不确定事件主要包含政策发布、经济危机等不可预测性事件，但由于难以具体量
化影响程度和影响时长，所以本文主要考量市场基本环境的影响。针对基本面，本文综合参
考文献，主要从宏观经济、能源价格、气候环境及国际市场四个方面进行假定：

假设1：宏观经济、气候环境及国际市场对碳交易价格具备正向作用

假设2：能源价格对碳交易价格具备负向作用

在上述假设的前提条件下，可以从时间维度和空间维度对影响因素的作用原理进行考察，而
静态面板回归模型同时包含了横截面、时期和变量三维信息，是用于分析k个影响因素在N个
横截面及T个时间点上的变动关系的模型，较单一的横截面模型和时间序列模型反映了更多
信息，从而更好地反映了各影响因素与碳交易价格之间的关系。结合当下国内市场已经具备
4年的数据积累以及8个试点地区的典型特征，为更加全面地反映市场信息，本文采用静态面
板回归模型进行影响因素的探究，并假定碳交易价格变动满足如下关系：

$$y_{it}=\alpha_{it}+x_{it}\prime\beta_{it}+\mu_{it}, \qquad
  i=1,2,\cdots,N,t=1,2,\cdots,T$$ {#eq:model1}

 $y_{it}$ 表示碳交易价格, $x_{it}$ 表示从市场基本环境所选择的重要影响因素，本文将通过
对当下研究文献中的影响因子进行归纳总结，初步选定因子后，采用Lasso回归进行变量
的筛选，从而避免主观确定重要影响因子的误导性，客观衡量影响碳交易价格的重要因素，$\alpha$ 和
 $\beta$ 为系数，其具体形式将根据面板回归模型中F检验及Hausman检验得到。

静态面板回归模型是解决碳交易价格定价的重要工具，但碳交易市场中对于需求方企业来说
更为重要的是二级市场中碳交易价格趋势的预测。本文结合上述影响因素的研究成果，分别
采用灰色BP神经网络模型进行碳交易价格的预测。

灰色BP神经网络模型是灰色预测模型和BP神经网络组合形成的预测方法。灰色预测是通
过少量的不完全的信息对未来一段时间的值进行预测，其适用于趋势较为明显的数据预测，
但对于受随机干扰较大的序列，其预测精度将有所降低，BP神经网络模型通过构建由多个非
线性的简单单元组成的并行互联的网络，可以有效地对非线性的数据样本的分析，同时灰色
预测模型解决了BP神经网络输入层随机的问题，两者的结合可以有效的完成一定时间范围内
的碳交易价格预测。

# 碳排放交易市场的实证分析

## 指标筛选

根据四个基本面——宏观经济、能源价格、气候环境和国际市场四个基本面分别选取了初步认为
对碳交易价格变化较大的因子，宏观经济面选取了国内外宏观经济指数上证指数和道琼斯指数以及企业
经营碳效率指数，能源价格主要选取了国内外原油、天然气和煤炭价格，气候环境主要考虑了
极端天气和空气质量两个因素，国际市场选择了汇率及国际碳交易价格两个方面。每一维度下的具体
指标和数据来源如表 \@ref(tab:tab-1) ：

```{r tab-1, eval=T, echo=F, results='markup', cache=F}  
tab1 <- read.csv('.\\result\\指标体系明细表.csv')
knitr::kable(tab1, row.names =F, align = "l", caption="指标体系明细表",
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

对于碳交易价格，从获取的数据来看，国内八个试点地区中天津、重庆的非交易比例分别为66%，76%，
为避免非交易日数据过多而造成结果的偏差，所以本文剔除了重庆和天津两个试点地区，最终以
2017年1月1日—2018年6月30日北京、上海、天津、广东、湖北及福建6个试点地区的数据为研究样本。
从解释变量的描述性结果表 \@ref(tab:tab-2) 得知，根据正态分布的“3σ”原则得知，各指标均有
部分数据尚未落在 $[μ-3σ,μ+3σ]$ 范围内，说明各指标均有极端值的存在，这部分数据可能会对
后续建模产生偏差，本文采用将误差值设置为正常范围内的最大值或最小值水平，以避免有用信息
损失过多。另外，由于国际市场和国内市场交易日期的不同，本文剔除了休息日及国内外15个假期
的影响，获取各试点有效交易日数据357天，共计2142个样本。为避免汇率的影响，本文统一货币
计量单位，分别对国外原油、国外天然气价格、国外煤炭价格以及核准减排量分别用原始数据
乘以汇率计算得到。最后，针对极端天气这一指标，本文采用通用认定当日最高温在35℃以上
称为高温天气，当日低温低于0℃称为低温天气设定虚拟变量，当气温高于35℃或0℃时，设为1，其
余设为0，从而完成数据的处理。

```{r tab-2, eval=T, echo=F, results='markup', cache=F}  
tab2 <- read.csv('./result/数据基本信息表.csv')
knitr::kable(tab2, row.names =F, align = "l", caption="数据基本信息表",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

在变量筛选和进行静态面板回归分析之前，本文对选取指标进行面板单位根检验以避免伪回
归的出现。本文采用Breitung检验，结果如表 \@ref(tab:tab-3) 。在原假设为所有面板均
存在单位根的前提下，影响因子除核证减排量、德克萨斯原油价格、纽卡斯尔煤炭价格外，
其他影响因子p值显著小于0.05，拒绝原假设，原面板数据变量均平稳。我们对核准减排量、
德克萨斯原油价格、纽卡斯煤炭价格转化为增长率后，进行Breitung检验，此时变换后的序
列平稳，此时我们命名核准减排量增长率、德克萨斯原油价格增长率、纽卡斯尔煤炭价格增
长率分别为CERChange、WTIChange、NEWCChange。这时所有因子均为平稳序列，满足进行面
板回归的基本要求。

```{r tab-3, eval=T, echo=F, results='markup', cache=F}
tab3 <- read.csv('./result/平稳性检验.csv')
knitr::kable(tab3, row.names =F, align = "l", caption="平稳性检验",
             digits=4,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

在进行平稳性检验后，根据Lasso原理我们将初始选取的指标进行标准化处理，以避免
量纲影响惩罚项的大小。本文根据lars包Lasso方法完成变量的选择，并采用10折交叉法
选择最为合适的调节参数。其中我们发现 $CV_{(75)}=0.9033$ ，为最小交叉验证误差，
根据针对共线性问题的最小角度回归原理对变量进行压缩，得到表 \@ref(tab:tab-4) 结果，
其中上证指数涨跌幅、道琼斯指数涨跌幅、德克萨斯原油增长率及纽卡斯尔煤炭价格增长率的系
数压缩至0，总计剔除4个变量，剩余8个重要因子。

```{r tab-4, eval=T, echo=F, results='markup', cache=F}
tab4 <- read.csv('./result/变量选择结果表.csv')
knitr::kable(tab4, row.names =F, align = "l", caption="变量选择结果表",
             digits=3,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

针对lasso回归选择出的变量，我们进行多重共线性和相关性检验，以避免变量之间存在多重
共线性或两两相关关系会影响到后续回归模型的建立。

首先，检验变量之间的两两相关性。计算两两相关系数得知除了国内天然气价格和国外天然气
价格相关系数为0.45外，其余变量的相关系数均不到0.1，这表明变量之间存在一定的相关性，
但不存在强相关关系，但我们仍需要进一步检验以确定相关性是否会引起多重贡献性对实验结果
产生影响。其次，我们针对所挑选的变量进行多重共线性的检验。通过计算膨胀因子VIF的值，
其值均小于10，容忍度大于0.1，明确表明变量之间不存在多重共线性，可以进行回归方程的建立。

## 基于稳健性估计下碳市场重要影响因素分析

### 模型构建

综合Lasso回归所选择的重要变量，我们对6个试点地区进行回归方程的建立，假定方程满足如下条件：

$$DealPrice=\mu_i+\beta_1 TanChange_{it}+\beta_2 Eco_{it}+\beta_3 Gas_{it}+\beta_4 Coal_{it}+\beta_5 ExWeather_{it}+\beta_6AQI_{it} \\
+\beta_7CERChange_{it}+\beta_8 ExChange_{it}+\epsilon_{it} \quad \quad i=1,2,3,4,5,6 \quad \quad t=1,2,...,357$$ {#eq:model4}

其中，$i$ 表示试点省份，$t$ 表示有效交易日。DealPrice为每日碳交易收盘价，TanChange表示
国内低碳排放公司绩效的增长率，ECO表示国际天然气的价格，Gas表示国内天然气的价格，
Coal表示国内煤炭的价格，ExWeather为极端天气，其中1表示日最高气温高于35℃或日低温低于0℃，
为极端天气，0表示处于正常气温，AQI表示空气质量指数，CERChange表示国际碳交易价格的变动，
ExChange为汇率的波动。扰动量由 $\mu_i+\epsilon_{it}$ 组成，其中 $\mu_i$ 表示个体效
应，$\epsilon_{it}$ 表示随机扰动项，为不可观测部分，并假定 $\epsilon_{it}$ 的均值为0，
方差为 $\sigma_\epsilon^2$ , 且 $\epsilon_{it}$ 与解释变量不相关。

### 模型识别

根据静态面板回归的原理得知，其系数向量的确认需要进一步的检验才能确定最终的方程形式，
在本文中需要判定研究的试点地区中每一个个体是否都拥有相同的方程，并进一步判断个体效应
的存在是否与解释变量相关，以建立最优模型。

首先，对于6个试点省份是否存在相同的截距项，是否存在个体和时期差异，进行F统计量的检验。
在原假设为 $\mu_1=\mu_2=,\cdots,=\mu_6=\mu_0$ ，即各个省份的截距项相同采用混合回归的前提下，
分别建立双固定效应模型，个体固定效应模型和时间固定效应模型，通过统计量的计算得到
 $F(5,1773)= 3533.02，F(5,2129)=3408.63，F(356,1778)=0.36$ ，由此说明我们应拒绝建立
混合回归的原假设，并建立个体效应模型，结果表明无时间效应的存在。

通过上一步的检验可以得出结论，不同省份是存在个体效应的，但在构建模型中，个体效应
是否与解释变量相关，仍然需要进一步的检验。我们采用Hausman检验确定模型的具体形式。
我们假定扰动项 $\mu_i$ 与解释变量无关。根据Hausman检验的原理得到统计量：$W=1896.24$ ，
p值远小于置信水平0.05，强烈拒绝原假设，由此确定建立个体固定效应模型。

在构建模型的过程中我们假定假定 $\{\epsilon_{it}\}$ 满足独立同分布的条件，但本文研究中有效
时期数357，6个省份，属于长面板数据，所以我们需要考 $\{\epsilon_{it}\}$ 是否存在的异方差
和自相关问题，因此我们需要对模型进行异方差和自相关检验。在原假设为“不同个体的
扰动项方差均相等的情况下，我们构造沃尔德统计量 $W=38922.23$ ,强烈拒绝同方差的原假设，
认为存在组间异方差。考虑原假设"不存在组内自相关"，进行自相关wald检验，根据stata
结果得知 $F(1,5) = 62.318$ ，犯第一类错误的概率为0.0005，强烈拒绝“不存在一阶组内
自相关”的原假设。考虑原假设“不存在组内同期相关”，根据残差相关系数矩阵对长面板数据
进行Breusch-Pagan LM检验， 结果显示Breusch-Pagan LM统计量 $\chi^2 (15)=591.713$ ，
p值小于0.0001,故强烈拒绝“无同期相关”的原假设，认为存在同期相关。

### 参数估计

根据上述检验结果得知扰动项 $\{\epsilon_{it}\}$ 存在组间异方差、组内自相关和组间同期相关。
为解决以上问题，本文将使用广义最小二乘法（FGLS）进行参数估计。结果如表 \@ref(tab:tab-5) ：

```{r tab-5, eval=T, echo=F, results='markup', cache=F}
options(knitr.kable.NA="")
tab5 <- read.csv('./result/参数估计结果.csv')
knitr::kable(tab5, row.names =F, align = "l", caption="参数估计结果",
             digits=4,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

根据上表结果得知国内低碳企业碳效率指数增长率、国内煤炭价格、国内外天然气对碳交易
价格有负向影响。其中国内煤炭价格对碳交易价格变动的影响在1%的置信水平下显著，当煤
炭价格增长率提升一个百分点时，碳交易价格下跌0.003元；国际天然气价格的影响在10%的
置信水平下显著，表明当天然气价格每上升100元，碳交易价格下跌0.11元；而国内天然气
和碳效率的影响不显著。对于碳交易价格有正向变动影响的因子为极端天气、空气质量指数、
国际碳交易价格的变动及汇率的变动。其中，当极端天气出现时，碳交易价格会上升0.451
元，且这种影响在1%的水平下显著，当空气质量指数上升1单位时，碳交易价格上升0.005元，
在1%的水平下显著。国际碳交易价格每增长1%时，碳交易价格上升0.006元，汇率每上升1%
时，碳交易价格上升0.179元。从截距项的差异来看，国内的碳交易价格水平从高到低依次
为：北京、上海、深圳、福建、湖北、广东，其与当下碳市场的现状高度符合，且北京属于
第一等级，福建、深圳、上海属于第二等级，广东和湖北属于第三等级。

## 碳交易价格预测分析

前文已完成了影响因素的分析，而后我们将聚焦于需求端企业对于碳交易价格预测方面的需
求。根据面板回归模型结果发现各因素对于碳交易价格影响存在横截面差异，但各影响因素
的作用机理基本相似。所以本文选取全国第一大、世界第三大碳交易市场广东，作为国内碳
交易价格交易的典型示范地区，进行后续碳交易价格预测的研究。

### 灰色BP神经网络模型下的碳交易价格预测

上述所筛选的重要影响因子是外界对于碳交易价格的冲击，灰色BP神经网络综合了灰色模型
预测未来变化趋势定性分析的特点和BP神经网络适用于非线性的样本定量分析的优点，能够
较好地反映出基于多种因素影响下碳排放权价格呈非线性变动的趋势。首先，使用单一的灰
色预测模型直接预测碳交易价格，其精度等级为不合格，说明单一的灰色预测效果不佳。为
提高预测精度本文对解释变量进行一定时期的预测后，采用BP神经网络来模拟碳交易价格的
形成过程从而完成为未来一定时期碳交易价格的预测。为尽可能避免由于随机因素对灰色预
测模型带来的误差的影响，本文对不同的解释变量采用了不同的预测过程，对空气质量指数、
国内煤炭价格及天然气价格采用直接建立灰色预测模型；对于碳效率变动率、国际碳交易价
格变动率及汇率变动率采用预测原始序列后，利用变动率公式进行计算得到；对于极端天气
这一虚拟变量采用分别预测日最高温和日最低温，然后根据极端天气的规则进行判别是否处
于极端天气中。

因自变量较多，本文以AQI为例，说明灰色预测的过程：

求解微分方程得到预测模型：

$$\hat{X}^{(1)} (k+1)=[\hat{X}^{(1)}(0)+\frac{82.27}{0.002}] e^{0.002k}-\frac{82.27}{0.002}$$ {#eq:model5}

由于GM(1,1)模型得到的是一次累加量，将GM(1,1)模型所得数据 $\hat{X}^{(1)}(k+1)$ 经过累减
还原为 $\hat{X}^{(0)}(k+1)$ ,即 $X^{(0)}$ 的灰色预测模型为：

$$\hat{X}^{(k+1)}=(e^{0.002}-1)[X^{(0)}(n)+\frac{82.27}{0.002}]e^{0.002k}$$ {#eq:model6}

并计算模型预测的残差平方和、平均相对误差及相对精度的值分别为43275.95，29.67%，
70.33%，由此计算后验差比值C值为0.64，判断其预测精度为勉强合格，同理得到其他因素
的未来10期的预测值，如表 \@ref(tab:tab-6) 所示。未来10期空气质量指数、煤炭价格呈
下降趋势，但中间有波动，日最高温、国际国际天然气价格、国内天然气价格呈上升趋势，
而国际碳交易价格增长率、碳效率指数变动率及汇率变动率保持稳定，其水平分别维持在
0.29,-0.65,0.34。从各影响因素的预测结果发现空气质量指数、日最高温和国际天然气价
格受随机影响因素影响较大，预测精度较其他影响因素较小，误差较大。而国际碳交易价格
变化率、碳效率指数变化率及汇率变动率预测效果较好，这从侧面反映了灰色模型对于具有
确定性趋势的序列预测效果更佳。

```{r tab-6, eval=T, echo=F, results='markup', cache=F}
tab6 <- read.csv('./result/灰色预测模型碳价影响因素精度表.csv')
knitr::kable(tab6, row.names =F, align = "l", caption="灰色预测模型碳交易价格影响因素精度表",
      digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

由于神经网络具有较强的适用性和容错能力，对历史数据建立训练模型，把灰色预测的数据
结果带入训练好的模型中，就可以得到充分考虑历史信息的预测结果。在对数据进行标准化
的基础上，利用已有样本357期数据进行神经网络模型的训练，其参数设置为误差参数为
$10^{-7}$ ，学习次数10000次，神经元的个数为显著影响碳交易价格变动的变量的数据8个，
经过480次迭代后收敛于82.55，得到模型，根据结果对未来10期进行预测，具体预测结果如
下。从图 \@ref(fig:fig1) 得知， 基于灰色BP神经网络的碳交易价格预测对于波动点的捕
捉比较准确，且能够拟合出数据的波动，但从图中得知神经网络的拟合效果在某些区域表现
不佳，准确性较低。

```{r tab-7, eval=T, echo=F, results='markup', cache=F}
tab7 <- read.csv('./result/神经网络预测结果.csv')
knitr::kable(tab7, row.names =F, align = "l", caption="神经网络预测结果",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

```{r fig1,eval=T,fig.align="center",out.width="100%", echo=F,fig.cap="神经网络预测结果",dev="png",results='markup', cache=F}
## setwd("E:/paper&project/paper/journal/carbon-emission")
library(data.table)
Data <- read.csv("./data/guangdong.csv",header = T,sep=",")
setcolorder(Data,c("AQIIndex","ClosePrice","Europe_change","Global_GasPrice","Eco_rmb","JDWeather","cer_rmb_diff","TAN180_Change","Deal"))
#network
predict_nnet <- read.csv("./data/predict_nnet_61.csv",header = T,sep=",")
predict_nnet <- as.vector(predict_nnet$V1)
par(mar=c(5,5,2,2)+0.1,oma=c(0, 0, 0, 0))
plot(predict_nnet[1:367],lty=1,type="b",pch=16,xlab="日期",ylab="碳价/元",xaxt="n",cex.lab=0.8,cex.axis=0.7,ylim=c(11,19))
points(Data[1:357,9],lty=2,type="b",pch=4)
axis(1,at=c(1,50,100,150,200,250,300,350),labels = c("2017/1/4","2017/3/23","2017/6/9","2017/8/21","2017/11/6",
                                                     "2018/1/7","2018/4/9","2018/6/21"),cex.axis=0.7)
legend("topright",c("预测值","真实值"),pch=c(16,4),lty=c(1,2),bty="n",cex=0.7)

```

### 预测准确性的度量

为了更为精准的评估每个模型的预测精度需要量化误差，MAPE不仅仅考虑预测值与真实值
的误差，还考虑了误差与真实值之间的比例，所以本文采用MAPE衡量预测方法和在时间维度
上预测的准确性，一般认为MAPE小于10，则模型的拟合精度较高。我们以2017年1月1日至
2018年6月30日为训练集，以2018年7月1日-2018年9月30日为测试集，预测了未来60期的碳交易价格，
并根据上述原理分别采用灰色预测与BP神经网络组合预测模型、ARMA可加新息异常回归以及
Prophet预测模型对碳交易价格预测并计算MAPE值，具体结果如图 \@ref(fig:fig4) 所示。

```{r fig4,eval=T, out.width="100%", echo=F,fig.cap="各模型平均绝对百分误差图",dev="png",results='markup', cache=F}
accuracy <- read.csv("./data/MAPE.csv",header =T,sep=",")
par(mar=c(5,5,2,2)+0.1, oma=c(0, 0, 0, 0))
plot(accuracy[,1],type="b",ylim=c(0,10),
     xlab="预测期",ylab="MAPE",lty=1,cex.lab=0.8,cex.axis=0.7,pch=18,lwd=1.5,cex=0.7)
lines(accuracy[,2],type="b",lty=2,pch=16,lwd=1.5,cex=0.7)
lines(accuracy[,3],type="b",lty=3,pch=4,lwd=1.5,cex=0.7)
legend("topright",c("灰色BP","Prophet","ARMA"),pch=c(18,16,4),
       lty=c(1,2,3),bty="n",cex=0.7)  
```

从方法的角度分析，对训练集的训练中，MAPE值ARMA<Prophet法<灰色BP神经网络法，说明
ARMA方法对原始数据拟合度最高，而灰色BP神经网络预测模型方法最差。从测试集的整体情
况来看，测试集的误差均大于训练集，但差别不大；三种方法在测试集的表现从长期看
Prophet的预测误差最小，灰色模型预测误差最大。从预测的时间区间来说，Prophet方法和
ARMA方法的MAPE值在5期内有短暂的上升后，MAPE值后续逐渐下降趋势，并且Prophet法下降
的速度快于ARMA方法，说明Prophet方法较传统时间序列方法相比，其稳健性更强；而灰色
预测模型方法的误差呈现出逐渐增大的特点，且在预测15期时，其误差超过Prophet方法，
在未来30期后期误差大于ARMA方法，其说明灰色BP神经网络模型适用于短期预测，其最佳预
测区间应控制在15期内，其预测结果也灰色预测各因素预测准确性有关。另外从模型构建的
简易程度来看，虽然Prophet模型相对于ARMA模型来讲理论基础更为复杂，但其建立在指数
平滑和ARMA模型的原理之上，并且针对拐点的判断及准确性的度量都显示的其独特的优势，
这无疑不是对碳交易市场的工作人员和企业碳研究人员的福音。

# 结论

通过上述的实证研究，一方面本文对一级市场中碳交易价格的形成做出了具体的解读，通过
Lasso回归对碳交易价格的影响因子进行筛选发现，我国碳交易市场价格主要受到煤炭价格、
国外天然气价格、汇率、空气质量指数、国内天然气价格、碳效率指数、极端天气和核准减
排量的影响，而国内外宏观经济、原油价格、国际煤炭价格对国内碳交易价格波动影响微弱。
进一步建立静态面板回归模型，进行FGLS稳健性估计得到，各因素对于各试点地区碳交易价
格的影响具备明显的截距项差异，且煤炭价格、天然气价格、极端天气及空气质量指数对我
国碳交易价格的影响显著，而碳效率指数、国内天然气价格及国际碳交易价格对我国碳市场
价格的影响显著，化石燃料的负向作用从煤炭价格、天然气价格到原油价格依次递减。另一
方面对于二级市场企业参与者来说，本文通过了从外部因素和内部自身波动出发分别建立了
灰色BP神经网络模型、ARMA模型和Prophet模型对碳交易价格进行预测和准确性的度量。得
出如下结论：1.灰色BP神经网络模型对于短期碳交易价格的趋势预测及波动相较于时间序列
预测方法更为准确，但误测的偏差在短时间内小，但长期的误差较大。2.比较传统时间序列
预测方法和Prophet方法得知，Prophet方法的预测准确度与传统预测方法不相上下，且
Prophet方法的预测准确性的波动幅度不大，稳健性强。相较于传统时间序列严格的假定条
件及模型设定流程，Prophet模型为对碳市场行情了解但统计方法运用仍有缺陷的分析人员
提供了预测渠道，为企业理性化决策提供了方法和建议。

根据上述结论，针对市场的不同主体，特提出如下建议：对于政府来说，其一化石燃料的价
格对于碳交易价格的波动具备负向作用，其中煤炭价格的负向作用尤为显著。作为一个以煤
炭燃烧为主要能源利用的国家，我国需要转变能源利用方式，提高能源利用效率，减少温室
气体的排放，逐步实现由“煤炭主导——天然气利用——清洁能源全面展开”的发展路径。其二，
建立“化石燃料——碳市场”的约束机制，鼓励市场化节能减排，促使企业衡量化石燃料燃料
成本与节能减排的收益绩效，从而转变其生产方式，促进技术和资金流向低碳发展领域，倒
逼企业淘汰落后产能，完成转型升级。其三，我国碳市场的市场化程度仍然不高，市场调节
机制仍不够完善，在推进全国碳市场的建设和市场定价的过程中，应关注各影响因素的变化
情况，分析预测各因子的未来变化趋势，并做好碳交易价格定价和运营指导工作。对于企业
而言，如何以最小的成本在碳市场中获得最大的利润空间是企业经营碳的重要原则之一，在
实际预测的过程中，可以采用灰色BP神经网络模型实现准确的趋势波动预测，其预测有效期
控制在15期内。Prophet模型相较与传统时间序列模型在模型拟合和操作上与传统时间序列
更具稳健性和操作性，可以准确预测出碳交易价格长期所处水平，对于碳市场中熟悉碳市场
的变化规律但统计理论知识尚不足够完善的研究人员，Prophet模型为其预测提供了便捷的
路径。三、综合两种方法结果可以较为全面地衡量未来一定时间内的碳交易价格水平，有助
于企业根据碳交易价格水平进行交易，做出经营决策。

# 参考文献
[//]: # (\bibliography{Bibfile})

