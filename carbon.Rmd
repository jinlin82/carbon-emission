---
title: "碳排放权交易价格影响因素分析及预测"
author: "Jin"
date: "2019-03-02"
output:
  bookdown::html_document2:
    number_sections: true
    seq_numbering: true
    fig_caption: true
    highlight: haddock
    theme: null
    md_extensions: +east_asian_line_breaks
    keep_md: true
    toc: false
    pandoc_args: ["--filter", "pandoc-crossref", "-M", "eqnPrefix="]
  bookdown::word_document2:
    fig_caption: true
    reference_docx: ./style/word-styles-02.docx
    md_extensions: +east_asian_line_breaks
    pandoc_args: ["--filter", "pandoc-crossref"]
  bookdown::pdf_document2:
    keep_tex: yes
    toc: false
    latex_engine: xelatex
    md_extensions: +east_asian_line_breaks
    pandoc_args: ["--listing", "--filter", "pandoc-crossref"]
css: ./style/markdown.css
autoEqnLabels: true
eqnPrefixTemplate: ($$i$$)
linkReferences: true
bibliography: msgarch.bib
csl: ./style/chinese-gb7714-2005-numeric.csl
link-citations: true
---

```{r setup, echo=F}
knitr::opts_knit$set(root.dir = getwd())
knitr::opts_chunk$set(echo = FALSE, results = 'hide')
knitr::opts_chunk$set(warning = FALSE, message=FALSE)
```

```{r prepare}
rm(list=ls())
options(digits=4)
options(scipen=100)
graphics.off()
Sys.setlocale("LC_ALL", "Chinese")
```

**摘要：** 本文从政府和企业的角度出发选取6个试点地区作为研究对象，以2017年1月1日至
2018年6月30的交易数据为训练集，以2018年7月1日至2018年9月30日为测试集，重点探究了国
内碳价格的影响因素的作用机理及碳价的短期预测问题，结果发现我国正处于受能源价格影响
的初级阶段，宏观经济影响微弱，股市联动性差，并且能源价格呈负向作用，这种负向作用从
煤炭、天然气到原油依次递减；对于碳价的预测问题宜采用灰色BP神经网络进行短期预测，有
效期需控制在15期内，长期预测可采用Prophet模型，其操作的便捷性和可分解性将为碳市场
研究人员带来诸多便利。

# 引言及文献综述
[//]: # 问题界定，文献综述，文章结构简述

近些年来，全球极端天气频繁发生，升温超过1℃，然而全球碳排放量与日俱增，2017年增长
1.6%，2018年增幅约为2.7%。若任由形势继续发展下去，必将严重威胁人类的生存与发展。
中国作为全球最大的温室气体排放国，对全球气候变化问题作出积极响应，与175个国家签署了
《巴黎气候协定》，并在多次政府工作会议中指出要加快推动碳市场的建设和碳金融的发展。
但我国起步较晚，在经历了4年试点地区探索后，2017年12月19日我国碳排放交易系统才正式
启动。当下我国正处于全面建设碳市场的初级阶段，处于全球碳交易链条的最底端，国际话语权
不足，同时市场机制尚未完善，其发展仍然存在很多制约因素，而价格作为调节碳交易市场的
经济手段，重点研究其影响因素的作用机理和把握价格变动规律，对于深入了解碳市场，使得
碳交易市场获得全面健康持久的发展具备重要的推动作用。

我国碳排放权交易市场是在欧盟排放权交易体系（EU ETS）基础之上建立而来的。与EUETS相比，
国内碳交易市场仍处于成长阶段，市场机制尚待完善。在国际市场已经逐渐形成了以宏观经济、
能源市场为主要影响因素，政策因素等其他因素为辅的影响系统时，我国学者利用当下碳试点
地区积累的数据，也纷纷开展了碳排放权价格的研究。王倩(2015)认为中国碳配额价格波动
主要由需求方主导，宏观经济、能源的相对价格以及温度变动都对碳配额价格有显著影响。
赵立祥(2016)研究得出市场环境是碳交易价格的最主要影响因素,政策因素和气候变化是碳
交易价格的主要影响因素,能源价格对碳交易价格也有一定的影响,但影响效果不明显。
樊艳艳(2017)采用FGLS方法发现煤炭价格波动对碳排放权交易价格有较大影响。但是
我们也发现在影响因子的探究中多数文献均为主观选择“重要”因子，采用回归方程探究其影响，
当下大数据发展迅速，我们可以结合大数据方法进行客观的变量筛选后探究其影响，多角度探索
影响因子的影响情况。

另一方面随着市场成熟度不断提高，交易者对于碳价波动的变化关注度越来越高，准确地预测
碳价对于市场参与者进行经济决策显得尤为重要。姚奕(2017)、胡根华(2018)分别通过EMD-SVM
模型和无穷活动率Levy过程分别对碳价进行了预测并取得较好效果，这说明了碳市场的价格预测
是可实施性的。然而复杂的统计方法选择和模型检验给碳市场的参差不齐的研究人员带来了诸多
不便。国外自动预测方法已经得到了较好的推广和应用，从Hyndman(2008)对自动ARIMA模型和
指数平滑模型进行改进实现对季节性数据和非季节性数据的预测到Livera A M D(2010)
基于状态空间框架提出了修正的指数平滑的自动预测方法，Taylor(2018)提出模块化的基于Prophet
方法的时间序列预测，自动预测理论领域已经涌现了丰硕的成果。但现阶段国内对于自动预测方法
的应用很少，对于在碳市场领域的应用则更少，但实现自动预测无疑是对碳市场交易人员的一大福音，
所以本文基于当下文献中发现的不足以及市场的迫切需求开展本文的研究，重点针对碳排放权的
影响因素及碳价的预测问题作出具体分析。

# 碳排放交易市场与理论简介

碳排放权交易是指政府设定强制的排放总量控制目标下，允许企业对碳排放权配额进行交易从而
形成的以市场机制为渠道的温室气体减排措施。而核心——碳价格的形成和波动实际上是在市场经济
的条件下，供需双方进行博弈，最终形成均衡价格的过程。具体看来，供给方是政府，其根据EU ETS
所获得的配额总量及各试点地区的实际情况分配碳排放权并制定初始价格；需求方为所需碳配额的企业，
当企业通过一定渠道获得配额后，其可以在二级市场进行配额交易，减排困难的企业向减排容易
的企业购买碳排放权，后者替前者完成减排任务，并获得收益。然而供需存在的缺口必然会造成
了二级市场碳价的波动，从而引起碳价的上升或下降。从上述运行原理我们发现碳价研究存在的
两个重点在于政府对于价格的初始制定即价格的形成和二级市场上价格变动的预测。

从政府层面来看，我国碳市场的总供给将在一定水平内保持平稳，并随着气候环境形势愈加严峻，
其供给会逐渐减少，供给曲线向左移动，总需求不变的前提下，碳价格上升。当然碳价格也会受到
需求端的影响，需求端的影响可以分为市场基本面和突发性事件两个方面，突发性事件主要包含
政策发布、金融危机等不可预测性事件，但由于难以具体量化影响程度和影响时长，所以本文
主要考量基本面的影响。针对基本面，本文综合参考文献，主要从宏观经济、能源价格、气候
环境及国际市场四个方面进行假定：

假设1：宏观经济、气候环境及国际市场对碳价具备正向作用

假设2：能源价格对碳价具备负向作用

在上述假设的前提条件下，可以从时间维度和空间维度对影响因素的作用原理进行考察，而静态
面板回归模型同时包含了横截面、时期和变量三维信息，是用于分析k个经济指标在N个界面成员
及T个时间点上的变动关系的模型，较单一的横截面模型和时间序列模型反映了更多信息，从而
更好地反映了各影响因素与碳价之间的关系。结合当下国内市场已经具备4年的数据积累以及
8个试点地区的典型特征，为更加全面地反映市场信息，本文采用静态面板回归模型进行影响
因素的探究，并假定碳价格变动满足如下关系：

$$y_{it}=a_{it}+x_{it}\prime\beta_{it}+\mu_{it}, \quad \quad  i=1,2,\cdots,N,t=1,2,\cdots,T$$ {#eq:model1}

$y_{it}$表示碳价格，$x_{it}$表示从基本面所选择的重要影响因素，本文将通过
对当下研究文献中的影响因子进行归纳总结，初步选定因子后，采用Lasso回归进行变量
的筛选，从而避免主观确定重要影响因子的误导性，客观衡量影响碳价的重要因素，$\alpha$和
$\beta$为系数，其具体形式将根据面板回归模型中F检验及Hausman检验得到。

静态面板回归模型是解决碳价定价的重要工具，但碳市场中对于需求方企业来说更为重要的是
二级市场中碳价趋势的预测。本文结合上述影响因素的研究成果和当下自动预测研究所带来的
重大意义两个方面出发，分别采用灰色BP神经网络模型和自动预测方法中ARMA模型和时间序列
的新应用成果Prophet模型进行碳价的预测。

其中灰色BP神经网络模型是灰色预测模型和BP神经网络组合形成的预测方法。灰色预测是
通过少量的不完全的信息对未来一段时间的值进行预测，其适用于趋势较为明显的数据预测，
对于受随机干扰较大的序列，其预测精度将有所降低，BP神经网络模型通过构建由多个非线性
的简单单元组成的并行互联的网络，可以有效地对非线性的数据样本的分析。两者的结合可以
有效的完成一定时间范围内的碳价预测。

ARMA模型和Prophet模型均为从碳价自身的波动出发，根据碳价的历史数据，分别基于历史数据
的某种形态是具备一定的稳定性和时间可加性思想实现碳价的预测。具体来看，ARMA模型是用
碳价作为因变量序列，用碳价的向过去推若干期的时间序列作为自变量序列，用来拟合波动曲线，
通过建立回归模型完成预测。对残差序列满足这两个假定——$e_t$为随机序列，在不同时刻
互不相关且$e_t$与时序的观测值$Y_{t+m}$不相关的前提下，建立线性回归模型：

$$ϕ(B)Y_t=θ(B)e_t$$ {#eq:model2}

而Prophet模型将原始序列拆分为趋势、季节、趋势和不规则波动四个部分，一方面可以从整体
预测未来趋势，另一方面也可以深入探究单个组件的影响，其表达式如下：

$$y(t)=g(t)+s(t)+h(t)+ϵ_t$$ {#eq:model3}

其中，$g(t)$为趋势模型，以分段线性函数来描述趋势的变化；$s(t)$用来衡量季节波动，主要是
基于傅里叶级数模拟每年的季节分量构建一个灵活的季节波动模型。$h(t)$为假期因素，主要通过
刻画由于特殊节日或者政策宣布对于时间序列波动的衡量，$ϵ_t$代表上述三个因素没有刻画的
变动情况。

# 碳排放权交易市场的实证分析

## 指标筛选

根据四个基本面——宏观经济、能源价格、气候环境和国际市场四个基本面分别选取了初步认为
对碳价变化较大的因子，宏观经济面选取了国内外宏观经济指数上证指数和道琼斯指数以及企业
经营碳效率指数，能源价格主要选取了国内外原油、天然气和煤炭价格，气候环境主要考虑了
极端天气和空气质量两个因素，国际市场选择了汇率及国际碳价两个方面。每一维度下的具体
指标和数据来源如表\@ref(tab:tab-1)：

```{r tab-1, eval=T, echo=F, results='markup', cache=F}  
tab1 <- read.csv('.\\result\\指标体系明细表.csv')
knitr::kable(tab1, row.names =F, align = "l", caption="指标体系明细表",
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

对于碳价格，从获取的数据来看，国内八个试点地区中天津、重庆的非交易比例分别为66%，76%，
为避免非交易日数据过多而造成结果的偏差，所以本文剔除了重庆和天津两个试点地区，最终以
2017年1月1日—2018年6月30日北京、上海、天津、广东、湖北及福建6个试点地区的数据为研究样本。
从解释变量的描述性结果表\@ref(tab:tab-2)得知，根据正态分布的“3σ”原则得知，各指标均有部分数据尚未落在
$[μ-3σ,μ+3σ]$范围内，说明各指标均有极端值的存在，这部分数据可能会对后续建模产生偏差，
本文采用将误差值设置为正常范围内的最大值或最小值水平，以避免有用信息损失过多。另外，
由于国际市场和国内市场交易日期的不同，本文剔除了休息日及国内外15个假期的影响，获取
各试点有效交易日数据357天，共计2142个样本。为避免汇率的影响，本文统一货币计量单位，
分别对国外原油、国外天然气价格、国外煤炭价格以及核准减排量分别用原始数据乘以汇率计算
得到。最后，针对极端天气这一指标，本文采用通用认定当日最高温在35℃以上称为高温天气，
当日低温低于0℃称为低温天气设定虚拟变量，当气温高于35℃或0℃时，设为1，其余设为0，从而完
成数据的处理。

```{r tab-2, eval=T, echo=F, results='markup', cache=F}  
tab2 <- read.csv('.\\result\\数据基本信息表.csv')
knitr::kable(tab2, row.names =F, align = "l", caption="数据基本信息表",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

在变量筛选和进行静态面板回归分析之前，本文对选取指标进行面板单位根检验以避免伪回归
的出现。本文采用Breitung检验，结果如表\@ref(tab:tab-3)。在原假设为所有面板均存在单位根的前提下，
影响因子除核证减排量、德克萨斯原油价格、纽卡斯尔煤炭价格外，其他影响因子p值显著
小于0.05，拒绝原假设，原面板数据变量均平稳。我们对核准减排量、德克萨斯原油价格、
纽卡斯煤炭价格转化为增长率后，进行Breitung检验，此时变换后的序列平稳，此时我们
命名核准减排量增长率、德克萨斯原油价格增长率、纽卡斯尔煤炭价格增长率分别为
CERChange、WTIChange、NEWCChange。这时所有因子均为平稳序列，满足进行面板回归
的基本要求。

```{r tab-3, eval=T, echo=F, results='markup', cache=F}  
tab3 <- read.csv('.\\result\\平稳性检验.csv')
knitr::kable(tab3, row.names =F, align = "l", caption="平稳性检验",
             digits=4,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

在进行平稳性检验后，根据Lasso原理我们将初始选取的指标进行标准化处理，以避免
量纲影响惩罚项的大小。本文根据lars包Lasso方法完成变量的选择，并采用10折交叉法
选择最为合适的调节参数。其中我们发现$CV_{(75)}=0.9033$，为最小交叉验证误差，
根据针对共线性问题的最小角度回归原理对变量进行压缩，得到表\@ref(tab:tab-4)结果，其中上证指数
涨跌幅、道琼斯指数涨跌幅、德克萨斯原油增长率及纽卡斯尔煤炭价格增长率的系数压缩
至0，总计剔除4个变量，剩余8个重要因子。

```{r tab-4, eval=T, echo=F, results='markup', cache=F}  
tab4 <- read.csv('.\\result\\变量选择结果表.csv')
knitr::kable(tab4, row.names =F, align = "l", caption="变量选择结果表",
             digits=3,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

针对lasso回归选择出的变量，我们进行多重共线性和相关性检验，以避免变量之间存在多重
共线性或两两相关关系会影响到后续回归模型的建立。

首先，检验变量之间的两两相关性。计算两两相关系数得知除了国内天然气价格和国外天然气
价格相关系数为0.45外，其余变量的相关系数均不到0.1，这表明变量之间存在一定的相关性，
但不存在强相关关系，但我们仍需要进一步检验以确定相关性是否会引起多重贡献性对实验结果
产生影响。其次，我们针对所挑选的变量进行多重共线性的检验。通过计算膨胀因子VIF的值，
其值均小于10，容忍度大于0.1，明确表明变量之间不存在多重共线性，可以进行回归方程的建立。

## 基于稳健性估计下碳市场重要影响因素分析

### 模型构建

综合Lasso回归所选择的重要变量，我们对6个试点地区进行回归方程的建立，假定方程满足如下条件：

$$DealPrice=μ_i+β_1 TanChange_{it}+β_2 Eco_{it}+β_3 Gas_{it}+β_4 Coal_{it}+β_5 ExWeather_{it}+β_6AQI_{it} \\
+β_7CERChange_{it}+β_8 ExChange_{it}+ϵ_{it} \quad \quad i=1,2,3,4,5,6 \quad \quad t=1,2,...,357$$ {#eq:model4}

其中，$i$表示试点省份，$t$表示有效交易日。DealPrice为每日碳交易收盘价，TanChange表示
国内低碳排放公司绩效的增长率，ECO表示国际天然气的价格，Gas表示国内天然气的价格，
Coal表示国内煤炭的价格，ExWeather为极端天气，其中1表示日最高气温高于35或日低温低于0，
为极端天气，0表示处于正常气温，AQI表示空气质量指数，CERChange表示国际碳价的变动，
ExChange为汇率的波动。扰动量由$μ_i+ϵ_{it}$组成，其中$μ_i$表示个体效应，$ϵ_{it}$表示
随机扰动项，为不可观测部分，并假定$ϵ_{it}$的均值为0，方差为$σ_ϵ^2$,且$ϵ_{it}$与解释
变量不相关。

### 模型识别

根据静态面板回归的原理得知，其系数向量的确认需要进一步的检验才能确定最终的方程形式，
在本文中需要判定研究的试点地区中每一个个体是否都拥有相同的方程，并进一步判断个体效应
的存在是否与解释变量相关，以建立最优模型。

首先，对于6个试点省份是否存在相同的截距项，是否存在个体和时期差异，进行F统计量的检验。
在原假设为$μ_1=μ_2=,\cdots,=μ_6=μ_0$，即各个省份的截距项相同采用混合回归的前提下，
分别建立双固定效应模型，个体固定效应模型和时间固定效应模型，通过统计量的计算得到
$F(5,1773)= 3533.02，F(5,2129)=3408.63，F(356,1778)=0.36$，由此说明我们应拒绝建立
混合回归的原假设，并建立个体效应模型，结果表明无时间效应的存在。

通过上一步的检验可以得出结论，不同省份是存在个体效应的，但在构建模型中，个体效应
是否与解释变量相关，仍然需要进一步的检验。我们采用Hausman检验确定模型的具体形式。
我们假定扰动项$μ_i$与解释变量无关。根据Hausman检验的原理得到统计量：$W=1896.24$，
$p$值远小于置信水平0.05，强烈拒绝原假设，由此确定建立个体固定效应模型。

在构建模型的过程中我们假定假定$\{ϵ_{it}\}$满足独立同分布的条件，但本文研究中有效
时期数357，6个省份，属于长面板数据，所以我们需要考虑$\{ϵ_{it}\}$是否存在的异方差
和自相关问题，因此我们需要对模型进行异方差和自相关检验。在原假设为“不同个体的
扰动项方差均相等的情况下，我们构造沃尔德统计量$W=38922.23$,强烈拒绝同方差的原假设，
认为存在组间异方差。考虑原假设"不存在组内自相关"，进行自相关wald检验，根据stata
结果得知$F(1,5) = 62.318$， 犯第一类错误的概率为0.0005，强烈拒绝“不存在一阶组内
自相关”的原假设。考虑原假设“不存在组内同期相关”，根据残差相关系数矩阵对长面板数据
进行Breusch-Pagan LM检验， 结果显示Breusch-Pagan LM统计量$χ^2 (15)=591.713$，
p值小于0.0001,故强烈拒绝“无同期相关”的原假设，认为存在同期相关。

### 参数估计

根据上述检验结果得知扰动项$\{ϵ_{it}\}$存在组间异方差、组内自相关和组间同期相关。
为解决以上问题，本文将使用广义最小二乘法（FGLS）进行参数估计。结果如表\@ref(tab:tab-5)：

```{r tab-5, eval=T, echo=F, results='markup', cache=F}  
options(knitr.kable.NA="")
tab5 <- read.csv('.\\result\\参数估计结果.csv')
knitr::kable(tab5, row.names =F, align = "l", caption="参数估计结果",
             digits=4,
      longtable = TRUE, booktabs = TRUE, linesep  = "",)
```

根据上表结果得知国内低碳企业碳效率指数增长率、国内碳价、国内外天然气对碳市场价格有
负向影响。其中国内煤炭价格对碳价变动的影响在1%的置信水平下显著，当煤炭价格增长率
提升一个百分点时，碳价下跌0.003元；国际天然气价格的影响在10%的置信水平下显著，表明
当天然气价格每上升100元，碳价下跌0.11元；而国内天然气和碳效率的影响不显著。对于碳价
有正向变动影响的因子为极端天气、空气质量指数、国际碳价的变动及汇率的变动。其中，当
极端天气出现时，碳价会上升0.451元，且这种影响在1%的水平下显著，当空气质量指数上升
1单位时，碳价上升0.005元，在1%的水平下显著。国际碳价每增长1%时，碳价上升0.006元，
汇率每上升1%时，碳价上升0.179元。从截距项的差异来看，国内的碳价水平从高到低依次为：
北京、上海、深圳、福建、湖北、广东，其与当下碳市场的现状高度符合，且北京属于高碳价
等级，福建、深圳、上海属于第二等级，广东和湖北属于第三等级。

## 碳价预测分析

前文已完成了影响因素的分析，而后我们将聚焦于需求端企业对于碳价预测方面的需求。根据
面板回归模型结果发现各因素对于碳价影响存在横截面差异，但各影响因素的作用机理基本相似。
所以本文选取全国第一大、世界第三大碳交易市场广东，作为国内碳价交易的典型示范地区，
进行后续碳价预测的研究。

### 灰色BP神经网络模型下的碳价预测

上述所筛选的重要影响因子是外界对于碳价的冲击，灰色BP神经网络综合了灰色模型预测未来
变化趋势定性分析的特点和BP神经网络适用于非线性的样本定量分析的优点，能够较好地反映
出基于多种因素影响下碳排放权价格呈非线性变动的趋势。首先，使用单一的灰色预测模型
直接预测碳价，其精度等级为不合格，说明单一的灰色预测效果不佳。为提高预测精度本文对
解释变量进行一定时期的预测后，采用BP神经网络来模拟碳价的形成过程从而完成为未来一定
时期碳价的预测。为尽可能避免由于随机因素对灰色预测模型带来的误差的影响，本文对不同
的解释变量采用了不同的预测过程，对空气质量指数、国内煤炭价格及天然气价格采用直接建立
灰色预测模型；对于碳效率变动率、国际碳价变动率及汇率变动率采用预测原始序列后，利用
变动率公式进行计算得到；对于极端天气这一虚拟变量采用分别预测日最高温和日最低温，然后
根据极端天气的规则进行判别是否处于极端天气中。

因自变量较多，本文以AQI为例，说明灰色预测的过程：

求解微分方程得到预测模型：

$$\hat{X}^{(1)} (k+1)=[\hat{X}^{(1)}(0)+\frac{82.27}{0.002}] e^{0.002k}-\frac{82.27}{0.002}$$ {#eq:model5}

由于GM(1,1)模型得到的是一次累加量，将GM(1,1)模型所得数据$\hat{X}^{(1)}(k+1)$经过累减
还原为$\hat{X}^{(0)}(k+1)$,即$X^{(0)}$的灰色预测模型为：

$$\hat{X}^{(k+1)}=(e^{0.002}-1)[X^{(0)}(n)+\frac{82.27}{0.002}]e^{0.002k}$$ {#eq:model6}

并计算模型预测的残差平方和、平均相对误差及相对精度的值分别为43275.95，29.67%，70.33%，
由此计算后验差比值C值为0.64，判断其预测精度为勉强合格，同理得到其他因素的未来10期
的预测值，如表\@ref(tab:tab-6)所示。未来10期空气质量指数、煤炭价格呈下降趋势，但中间有波动，
日最高温、国际国际天然气价格、国内天然气价格呈上升趋势，而国际碳价增长率、碳效率
指数变动率及汇率变动率保持稳定，其水平分别维持在0.29,-0.65,0.34。从各影响因素
的预测结果发现空气质量指数、日最高温和国际天然气价格受随机影响因素影响较大，
预测精度较其他影响因素较小，误差较大。而国际碳价变化率、碳效率指数变化率及汇率变动率
预测效果较好，这从侧面反映了灰色模型对于具有确定性趋势的序列预测效果更佳。

```{r tab-6, eval=T, echo=F, results='markup', cache=F}  
tab6 <- read.csv('.\\result\\灰色预测模型碳价影响因素精度表.csv')
knitr::kable(tab6, row.names =F, align = "l", caption="灰色预测模型碳价影响因素精度表",
      digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

由于神经网络具有较强的适用性和容错能力，对历史数据建立训练模型，把灰色预测的数据
结果带入训练好的模型中，就可以得到充分考虑历史信息的预测结果。在对数据进行标准化
的基础上，利用已有样本357期数据进行神经网络模型的训练，其参数设置为误差参数为$10^{-7}$，
学习次数10000次，神经元的个数为显著影响碳价变动的变量的数据8个，经过480次迭代后
收敛于82.55，得到模型，根据结果对未来10期进行预测，具体预测结果如下。从图1得知， 
基于灰色BP神经网络的碳价预测对于波动点的捕捉比较准确，且能够拟合出数据的波动，但
从图中得知神经网络的拟合效果在某些区域表现不佳，准确性较低。 

```{r tab-7, eval=T, echo=F, results='markup', cache=F}  
tab7 <- read.csv('.\\result\\神经网络预测结果.csv')
knitr::kable(tab7, row.names =F, align = "l", caption="神经网络预测结果",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

```{r fig1,eval=T, echo=F,fig.cap="神经网络预测结果",dev="png"}
knitr::include_graphics(".\\result\\神经网络预测结果.png")
```

### ARMA模型下的碳价预测

基于碳价的历史波动，本文主要基于经典ARMA模型和Prophet模型对碳价进行预测。
首先进行ARMA模型的建立。对广东碳交易市场价格序列进行平稳性检验，在原假设为
序列存在单位根的假设下，经结果表明ADF值为-3.8952，p值为0.0023,p值小于置信度
水平5%，所以拒绝原假设，表明原始序列平稳。对平稳时间序列，为探究其自身价格
变动的原因，进行自相关和偏自相关检验，结果显示自相关函数拖尾，偏自相关函数二阶截尾。
我们建立模型为ARMA(2,0)。具体形式如下：

$$\begin{array}{1}
Deal_t=14.14+0.59Deal_{t-1}+0.31Deal_{t-2}+ϵ_t 	\\
\quad \quad \quad \quad( 0.05) \quad \quad \quad (0.05)  \quad \quad \quad \quad  ( 0.36 ) 
\end{array}$$ {#eq:model7}

为衡量模型的拟合优劣，对模型的残差进行正态性检验和自相关检验。应用残差的
Shapiro-Wilk正态检验得到统计量值为W=0.9144,相对应的p值显著小于置信水平0.05,
说明残差并不符合正态性的假定，结合Q-Q图分析发现，可能是由于原始序列存在异常值
导致了正态假定无法通过。我们对模型进行AO,IO检验，结果显示2017/1/5、5/23、
2018/3/29、6/13、6/28存在可加异常值，剔除可加异常值后发现2017/2/3存在新息异常值，
对此我们建立新息异常回归。此时我们发现AIC值由758.62减少为615.75，且IO效应显著，
系数显著，未发现新的异常值。进行Ljung-Box检验结果中$Q=30.23$，p值等于0.17，所以
没有证据拒绝误差项不相关的原假设，表明该模型拟合效果好。

$$\begin{array}{1}
Deal_t=14.11+0.79Deal_{t-1}+0.18Deal_{t-2}-1.60IO+ϵ_t	\\
\quad \quad \quad \quad (0.37) \quad \quad (0.05)  \quad \quad \quad( 0.05 ) \quad \quad \quad(0.46) 
\end{array}$$ {#eq:model8}

根据上述绘制出图2发现，ARMA可加异常新息模型对于训练集样本拟合度
非常高，对未来10进行短期预测，预测结果显示未来10期碳价水平处于14元，并呈小幅度
波动，处于平稳状态。

```{r tab-8, eval=T, echo=F, results='markup', cache=F}  
tab8 <- read.csv('.\\result\\ARMA模型预测结果.csv')
knitr::kable(tab8, row.names =F, align = "l", caption="ARMA模型预测结果",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

```{r fig2,eval=T, echo=F,fig.cap="ARMA模型预测效果图",dev="png"}
knitr::include_graphics(".\\result\\ARMA模型预测效果图.png")
```

### Prophet模型下的碳价预测

其次，基于Prophet模型进行预测。根据实际交易情况得知，碳交易市场在节假日及
休息日不交易，所以本文不考虑假期的影响，重点关注趋势因素，并考虑是否有周期
因素的影响。根据建立ARMA过程的结果来看，原序列存在异常值，在构建Prophet的
过程中将其设为缺失值（相对于ARMA模型需要连续数据的基础上，Prophet在模型搭建
的优势体现之一）。从数据的走势来看数据存在多个改变点并存在趋势的改变，同时
为避免过拟合问题，设置改变点为25，且设置数据变动在5%的水平下受异常值得影响，
建立模型得到：

$$\begin{array}{1}
y(t)=g(t)+s(t)+ϵ_t \\
g\left( t \right) = ( - 0.45 + 0.03\alpha \left( {t{)^T}} \right)t + (0.91 + \alpha \left( {t{)^T}\gamma } \right)\\
{\gamma _j} = \left( {{s_j} + 0.45 - \mathop \sum \limits_{l < j} {\gamma _l}} \right)\left( {1 - \frac{{ - 0.45 + \mathop \sum \nolimits_{l < j} {\delta _l}}}{{ - 0.45 + \mathop \sum \nolimits_{l \le j} {\delta _l}}}} \right)\\
s\left( t \right) = X\left( t \right)\beta 
\end{array}$$ {#eq:model9}

根据上述模型进行预测，得到表\@ref(tab:tab-9)所示结果，红色曲线的尾部未来10期
呈现出下降趋势，其波动幅度较ARMA方法相比范围更大，但碳价水平基本稳定在13-14元。
进一步分解为趋势和周期性函数，我们得到广东省碳价整体趋势呈现出先降后升的趋势，
其转折点在2017年11月份，样本所显示出的周期呈现出10月至次年2月碳价偏高。因前文
采取样本的限制，而后进一步选择2015年1月1日至2018年6月30日的样本进行年度周期性
的研究发现，碳价的高峰期呈现了两个波峰，分为存在于8月-9月和4月，从而侧面证明了
气候因素对碳价是有影响的。同时我们发现Prophet模型对于碳价的趋势模拟的很好，
且碳价发生趋势性变化时也能较好的进行捕捉，异常波动点总是围绕预测值中心附近变动。
对比Prophet模型和ARMA模型的结果来看，Prophet模型对异常值更具有稳健性，其不会
随着异常值点造成剧烈的波动，而ARMA则容易受到异常值点的影响，从而造成整个结果的偏差。

```{r tab-9, eval=T, echo=F, results='markup', cache=F}  
tab9 <- read.csv('.\\result\\Prophet模型预测结果.csv')
knitr::kable(tab9, row.names =F, align = "l", caption="Prophet模型预测结果",
             digits=2,
      longtable = TRUE, booktabs = TRUE, linesep  = "")
```

```{r fig3,eval=T, echo=F,fig.cap="Prophet模型预测结果",dev="png"}
knitr::include_graphics(".\\result\\Prophet模型预测结果.png")
```

同时，对比Prophet模型预测的结果图3和灰色BP神经网络预测模型结果
图4分析发现，整体上Prophet的模型拟合曲线比较平滑，清晰的描绘了
碳价格的整体趋势及变化规律。而从灰色BP神经网络预测模型的预测结果可以发现，
拟合曲线与原始曲线的波动状态大致保持一致，且对于波动点的描绘较Prophet模型更具
优势，较好的模拟了碳价的波动状态。从预测数据来看，灰色BP神经网络预测方法得到
的结果在未来的第三期时有明显下跌的趋势，并在未来第六期时碳价有缓慢回升的趋势，
其价格低于趋于前期价格未下降的水平值，而Prophet模型整体呈下降趋势，无拐点存在。
结合未来10期的真实交易来看，未来10碳价的波动状态与灰色预测模型的波动状态基本
保持一致，且其真实值滞后一期，说明灰色BP神经网络模型有预测趋势的效果，但碳价预测
值低于真实值，且差异在2元左右。而Prophet没有描述出具体碳价的波动状态，但碳价格预测
水平与真实值更为接近。

### 预测准确性的度量

为了更为精准的评估每个模型的预测精度需要量化误差，MAPE不仅仅考虑预测值与真实值
的误差，还考虑了误差与真实值之间的比例，所以本文采用MAPE衡量预测方法和在时间维度
上预测的准确性，一般认为MAPE小于10，则模型的拟合精度较高。我们以2017年1月1日至
2018年6月30日为训练集，以2018年7月1日-2018年9月30日为测试集，预测了未来60期的碳价，
并根据上述原理分别采用灰色预测与BP神经网络组合预测模型、ARMA可加新息异常回归以及
Prophet预测模型对碳价预测并计算MAPE值，具体结果如图4所示。

```{r fig4,eval=T, echo=F,fig.cap="各模型平均绝对百分误差图",dev="png"}
knitr::include_graphics(".\\result\\各模型平均绝对百分误差图.png")
```

从方法的角度分析，对训练集的训练中，MAPE值ARMA<Prophet法<灰色BP神经网络法，
说明ARMA方法对原始数据拟合度最高，而灰色BP神经网络预测模型方法最差。从测试集
的整体情况来看，测试集的误差均大于训练集，但差别不大；三种方法在测试集的表现
从长期看Prophet的预测误差最小，灰色模型预测误差最大。从预测的时间区间来说，
Prophet方法和ARMA方法的MAPE值在5期内有短暂的上升后，MAPE值后续逐渐下降趋势，
并且Prophet法下降的速度快于ARMA方法，说明Prophet方法较传统时间序列方法相比，
其稳健性更强；而灰色预测模型方法的误差呈现出逐渐增大的特点，且在预测15期时，
其误差超过Prophet方法，在未来30期后期误差大于ARMA方法，其说明灰色BP神经网络
模型适用于短期预测，其最佳预测区间应控制在15期内，其预测结果也灰色预测各因素
预测准确性有关。另外从模型构建的简易程度来看，虽然Prophet模型相对于ARMA模型
来讲理论基础更为复杂，但其建立在指数平滑和ARMA模型的原理之上，并且针对拐点的
判断及准确性的度量都显示的其独特的优势，这无疑不是对碳交易市场的工作人员和
企业碳研究人员的福音。

# 结论与建议

通过上述的实证研究，一方面本文对一级市场中碳价的形成做出了具体的解读，通过Lasso回归
对碳价的影响因子进行筛选发现，我国碳交易市场价格主要受到煤炭价格、国外天然气价格、
汇率、空气质量指数、国内天然气价格、碳效率指数、极端天气和核准减排量的影响，而
国内外宏观经济、原油价格、国际煤炭价格对国内碳价波动影响微弱。进一步建立静态面板
回归模型，进行FGLS稳健性估计得到，各因素对于各试点地区碳价的影响具备明显的截距项
差异，且煤炭价格、天然气价格、极端天气及空气质量指数对我国碳价的影响显著，而碳效率
指数、国内天然气价格及国际碳价对我国碳市场价格的影响显著，化石燃料的负向作用从煤炭
价格、天然气价格到原油价格依次递减。另一方面对于二级市场企业参与者来说，本文通过了
从外部因素和内部自身波动出发分别建立了灰色BP神经网络模型、ARMA模型和Prophet模型对
碳价进行预测和准确性的度量。得出如下结论：1.灰色BP神经网络模型对于短期碳价的趋势
预测及波动相较于时间序列预测方法更为准确，但误测的偏差在短时间内小，但长期的误差较大。
2.比较传统时间序列预测方法和Prophet方法得知，Prophet方法的预测准确度与传统预测方法
不相上下，且Prophet方法的预测准确性的波动幅度不大，稳健性强。相较于传统时间序列严格
的假定条件及模型设定流程，Prophet模型为对碳市场行情了解但统计方法运用仍有缺陷的分析
人员提供了预测渠道，为企业理性化决策提供了方法和建议。

根据上述结论，针对市场的不同主体，特提出如下建议：对于政府来说，其一化石燃料的价格
对于碳价的波动具备负向作用，其中煤炭价格的负向作用尤为显著。作为一个以煤炭燃烧为
主要能源利用的国家，我国需要转变能源利用方式，提高能源利用效率，减少温室气体的排放，
逐步实现由“煤炭主导——天然气利用——清洁能源全面展开”的发展路径。其二，建立“化石燃料——
碳市场”的约束机制，鼓励市场化节能减排，促使企业衡量化石燃料燃料成本与节能减排的收益
绩效，从而转变其生产方式，促进技术和资金流向低碳发展领域，倒逼企业淘汰落后产能，完成
转型升级。其三，我国碳市场的市场化程度仍然不高，市场调节机制仍不够完善，在推进全国
碳市场的建设和市场定价的过程中，应关注各影响因素的变化情况，分析预测各因子的未来变化
趋势，并做好碳价定价和运营指导工作。对于企业而言，如何以最小的成本在碳市场中获得最大
的利润空间是企业经营碳的重要原则之一，在实际预测的过程中，可以采用灰色BP神经网络模型
实现准确的趋势波动预测，其预测有效期控制在15期内。Prophet模型相较与传统时间序列模型
在模型拟合和操作上与传统时间序列更具稳健性和操作性，可以准确预测出碳价长期所处水平，
对于碳市场中熟悉碳市场的变化规律但统计理论知识尚不足够完善的研究人员，Prophet模型为
其预测提供了便捷的路径。三、综合两种方法结果可以较为全面地衡量未来一定时间内的碳价水平，
有助于企业根据碳价水平进行交易，做出经营决策。

# 参考文献


